# 프롬프트 엔지니어링

**프롬프트 엔지니어링\index{프롬프트 엔지니어링}(Prompt Engineering)**은 AI 언어 모델로부터 구체적이고 정확하며 관련성 있는 응답을 도출하기 위해 프롬프트(Prompt, 지시명령어)를 설계하고 개선하는 과정이다. OpenAI의 GPT, Anthropic의 Claude, Google의 Gemini 등 다양한 AI 모델들이 등장하면서 프롬프트의 품질이 AI 모델 출력결과에 큰 영향을 미칠 수 있기 때문에 이 작업은 매우 중요하다.

## 프롬프트 엔지니어링의 핵심 가치

프롬프트 엔지니어링은 **파인튜닝보다 훨씬 빠르고 효율적**이며, 짧은 시간 내에 성능을 크게 향상시킬 수 있다. 또한 프롬프트는 **인간이 읽을 수 있는 형태**로 모델이 받는 정보를 정확히 보여주므로 투명성과 디버깅이 용이하다. 무엇보다 파인튜닝과 달리 **모델의 광범위한 지식을 그대로 유지**하면서도 원하는 동작을 이끌어낼 수 있다.

프롬프트 엔지니어링을 코딩에 적용할 때의 장점은 자연어로 의도를 표현할 수 있어 코딩 입문자도 쉽게 접근할 수 있고, 수많은 프로그래밍 언어에 대한 장벽이 크게 낮아진 것을 들 수 있다. 몇년전 영어가 가장 뜨거운 프로그래밍 언어라는 주장이 허언은 아닌 것이다.

{{< tweet user=karpathy id=1617979122625712128 >}}

프롬프트 엔지니어링을 코딩에 적용하는 절차는 전통적인 코딩 절차와 크게 다르지 않다. 첫째로 목표를 설정하여 작성하려는 코드의 정확한 기능과 요구사항을 명시한다. 둘째로 구조화 태그(예: XML, Markdown)를 활용해 상세하고 구체적인 프롬프트를 작성한다. 셋째로 유사한 코드 예시를 3-5개 포함하여 AI가 원하는 패턴을 정확히 이해할 수 있도록 돕는다. 넷째로 복잡한 작업은 여러 프롬프트로 나누어 단계별로 처리한다. 마지막으로 생성된 코드를 검토하고 필요한 경우 프롬프트를 개선하여 더 나은 결과를 얻는다.

![챗GPT 코딩 작업흐름](images/prompt.png){#fig-gpt-coding-workflow}


## 프롬프트 구성요소

프롬프트 엔지니어링의 성공은 체계적인 구성요소의 이해와 활용에 달려있다. 효과적인 프롬프트는 크게 두 가지 차원으로 구분된다. 첫째는 프롬프트의 기본 골격을 이루는 **핵심 요소**로, 페르소나, 지시사항, 예시와 맥락, 입력 데이터, 출력 지표로 구성된다. 둘째는 AI 응답의 품질과 특성을 정밀하게 조절하는 **SALT 출력 제어**로, 스타일(Style), 청중(Audience), 길이(Length), 어조(Tone)의 네 가지 차원을 통해 원하는 결과물을 얻을 수 있다. 이 두 차원을 적절히 조합하면 목적에 완벽하게 부합하는 AI 응답을 생성할 수 있다.

### 핵심 요소

효과적인 프롬프트를 작성하기 위해서는 다섯 가지 핵심 구성요소를 이해하고 활용해야 한다. 첫 번째는 **페르소나\index{페르소나}(Persona)**로, AI가 특정 전문가나 역할의 관점에서 응답하도록 맥락을 설정하는 것이다. 예를 들어 "당신은 경험이 풍부한 데이터 과학자입니다"라고 명시하면 AI는 해당 분야의 전문 지식과 용어를 활용하여 응답한다.

두 번째 핵심 요소는 **지시사항\index{지시사항}(Instruction)**이다. 이는 AI가 수행해야 할 작업을 구체적이고 명확하게 전달하는 부분으로, 모호함을 최소화하고 정확한 결과를 얻기 위해 필수적이다. 세 번째로 **예시\index{예시}와 맥락(Examples/Context)**을 제공함으로써 AI가 원하는 출력 형식과 스타일을 정확히 이해할 수 있도록 돕는다. 이는 특히 복잡한 작업이나 특정 형식이 요구될 때 매우 효과적이다.

네 번째 구성요소인 **입력 데이터(Input data)**는 AI가 실제로 처리해야 할 구체적인 정보를 의미한다. 이는 분석할 텍스트, 코드, 데이터셋 등 다양한 형태가 될 수 있다. 마지막으로 **출력 지표(Output indicator)**는 원하는 결과물의 형식, 구조, 길이 등을 명시하여 AI의 응답을 원하는 방향으로 유도하는 역할을 한다.

### SALT 출력 제어

프롬프트의 출력을 더욱 정밀하게 제어하기 위해서는 SALT 프레임워크\index{SALT 프레임워크}를 활용할 수 있다. SALT는 네 가지 차원에서 AI의 응답을 조절하는 방법론이다. **스타일(Style)**은 응답의 문체와 표현 방식을 결정하며, 학술적, 대화적, 기술적 등 다양한 스타일을 지정할 수 있다. **청중(Audience)**은 응답의 대상이 되는 독자층을 명시하여, 전문가 대상인지 일반인 대상인지에 따라 설명의 깊이와 용어 사용을 조절한다.

**길이(Length)**는 응답의 상세도와 분량을 제어하는 요소로, "한 문단으로 요약" 또는 "상세한 단계별 설명"과 같이 구체적으로 지정할 수 있다. 마지막으로 **어조(Tone)**는 글의 전반적인 분위기와 감정을 설정하는데, 전문적, 친근한, 격려하는 등의 어조를 통해 응답의 뉘앙스를 조절할 수 있다. 이러한 SALT 요소들을 적절히 조합하면 목적에 완벽히 부합하는 AI 응답을 얻을 수 있다.

```{mermaid}
%%| label: fig-prompt-components
%%| fig-width: 6
%%| fig-cap: 프롬프트 핵심요소와 SALT
graph TB
    A[프롬프트 구성]
    A --> B[핵심 요소]
    A --> C[출력 제어]

    subgraph SALT
    C --> I[스타일]
    C --> J[청중]
    C --> K[길이]
    C --> L[어조]
    end

    subgraph CORE[핵심 요소]
    B --> E[페르소나]
    B --> Z["입력<br>데이터"]    
    B --> M[지시사항]
    B --> G["맥락<br>예시"]
    B --> F["출력<br>형식"]
    end
```


## 8가지 핵심 기법 

주요 AI 기업들의 연구를 종합하면, 프롬프트 기법은 **가장 광범위하게 효과적인 것부터 특수한 상황에 사용하는 것까지** 다음과 같은 순서로 정리할 수 있다. 이는 Anthropic의 연구[@anthropic2024prompt]를 기반으로 OpenAI와 Google의 모범 사례를 통합한 것이다.

### 명확하고 직접적 작성

기본 중의 기본이다. **"능력이 부족한 인턴에게 설명하듯이"** 구체적으로 지시하라. 모호한 표현 대신 정확한 수치를 사용하라.

**잘못된 예시:**
```markdown
간결하게 작성하세요.
```

**개선된 예시:**
```markdown
2-3문장으로 제한하여 핵심만 요약하세요.
```

### 예시 활용하기

프롬프트 공학에서 멀티샷 프롬프팅\index{멀티샷 프롬프팅}을 **"비밀 무기 단축키"**라고 부른다. 
3-5개의 다양하고 관련성 있는 예시를 포함하면 AI가 정확히 무엇을 원하는지 이해한다.

```xml
<examples>
<example>
입력: def add(a, b): return a + b
출력: 두 숫자를 더하는 함수입니다.
</example>
<example>
입력: def multiply(x, y): return x * y
출력: 두 숫자를 곱하는 함수입니다.
</example>
</examples>

입력: def subtract(m, n): return m - n
출력:
```

### AI에게 생각할 시간 주기

프롬프트 공학에서 혁명을 가져왔던 사고 연쇄\index{사고 연쇄}(chain of thought). AI에게 사고 과정을 명시하도록 지시하라. Claude의 경우 `<thinking>` 태그를, GPT의 경우 "Let's think step by step"을, Gemini의 경우 단계별 추론을 사용할 수 있다. 
이는 복잡한 추론이나 계산이 필요한 작업에서 특히 효과적이다.

```xml
다음 코드의 시간 복잡도를 분석하세요.

<thinking>
먼저 코드를 단계별로 분석하고, 각 단계의 시간 복잡도를 계산한 다음, 
전체 시간 복잡도를 도출하세요.
</thinking>

<answer>
최종 답변을 여기에 작성하세요.
</answer>
```

### 구조화된 프롬프트

프롬프트를 구조화하면 AI의 이해도와 성능이 크게 향상된다. Claude는 XML 태그\index{XML 태그}(`<instructions>`, `<example>`, `<input>`)에 최적화되어 있고, GPT는 Markdown 형식(`### Instructions`, `#### Example`)을, Gemini는 JSON 형식을 잘 인식한다.

```xml
<instructions>
이 고객 피드백을 분석하고 문제를 카테고리화하세요.
- 카테고리: UI/UX, 성능, 버그, 기능 요청
- 감정 분석: 긍정적/중립적/부정적
- 우선순위: 높음/중간/낮음
</instructions>

<example>
<input>새 대시보드가 너무 느려서 답답해요!</input>
<output>
카테고리: 성능
감정: 부정적
우선순위: 높음
</output>
</example>

<input>{{customer_feedback}}</input>
```

### 역할 부여 

AI에게 특정 전문가나 페르소나의 역할을 부여하면 맥락에 맞는 응답을 생성한다.
이를 위해 시스템 프롬프트를 사용해서 역할을 부여한다.

```markdown
당신은 20년 경력의 시니어 Python 개발자입니다. 
코드 리뷰 시 성능, 가독성, 유지보수성을 중점적으로 검토합니다.
다음 코드를 리뷰해주세요:
```

### 응답 미리 채움 

AI의 응답을 특정 형식으로 시작하게 하여 출력을 제어할 수 있다. 특히 **JSON 출력**에 유용하다.

```markdown
다음 함수의 문서를 JSON 형식으로 작성하세요.

Assistant: {
  "function_name": "calculate_average",
  "parameters": [
```

### 복잡한 프롬프트 연결

큰 작업을 **작은 하위 작업으로 나누어** 순차적으로 처리하라. 한 프롬프트의 출력을 다음 프롬프트의 입력으로 사용한다.

```markdown
프롬프트 1: 이 코드베이스에서 모든 API 엔드포인트를 찾아 리스트로 만드세요.
프롬프트 2: [프롬프트 1의 결과]를 바탕으로 각 엔드포인트의 보안 취약점을 분석하세요.
프롬프트 3: [프롬프트 2의 결과]를 바탕으로 수정 코드를 생성하세요.
```

### 긴 컨텍스트 활용 팁

최신 AI 모델들의 확장된 컨텍스트 기능을 구조화와 함께 사용하여 긴 문서를 효과적으로 처리한다. Claude\index{Claude}는 200K 토큰, GPT-4는 128K 토큰, Gemini Pro\index{Gemini Pro}는 1M 토큰까지 처리 가능하다.

```xml
<document>
<section name="introduction">
[긴 문서 내용]
</section>
<section name="main_content">
[핵심 내용]
</section>
</document>

<task>
main_content 섹션의 핵심 논점을 3가지로 요약하세요.
</task>
```

## 프롬프트 엔지니어링 심화

프롬프트 엔지니어링의 진정한 가치는 기본 기법들을 상황에 맞게 조합하고 응용할 때 나타난다. 앞서 제시된 8가지 핵심 기법은 개별적으로도 효과적이지만, 이들을 전략적으로 결합하면 훨씬 더 강력한 프롬프트를 만들 수 있다. 예를 들어, XML 태그를 멀티샷 프롬프팅과 사고 연쇄와 결합하면 초구조화된 고성능 프롬프트를 생성할 수 있다. 전문 알고리즘 튜터 역할을 부여하고, 3-5개의 알고리즘 설명 예시를 제공한 뒤, 사고 과정을 통해 알고리즘의 핵심 아이디어를 파악하고 시간/공간 복잡도를 분석하며 구현상 주의점을 도출하도록 하는 방식이 그 예다.

실제로 프롬프트를 작성할 때는 몇 가지 실용적인 원칙을 따르는 것이 중요하다. 예시를 작성할 때는 해결하려는 문제와 직접적으로 관련된 것을 선택하고, 엣지 케이스를 포함한 다양한 시나리오를 제시하며, 입력과 출력이 명확하게 구분되도록 작성해야 한다. 또한 동적 콘텐츠가 필요한 경우 `{{변수명}}` 형식을 사용하여 템플릿\index{템플릿}을 재사용 가능하게 만들 수 있다. 예를 들어 `{{programming_language}}로 {{algorithm_name}} 알고리즘을 구현하세요`와 같은 템플릿을 만들면 다양한 언어와 알고리즘 조합에 활용할 수 있다.

특히 RAG\index{RAG}(Retrieval-Augmented Generation) 애플리케이션을 구축할 때는 AI가 확실하지 않은 정보에 대해 "모르겠습니다"라고 말할 수 있도록 명시적으로 허용하는 것이 중요하다. 이는 AI의 환각\index{환각}(hallucination)을 최소화하고 신뢰성을 높이는 핵심 전략이다. "제공된 문서에서 답을 찾을 수 없다면 '문서에서 해당 정보를 찾을 수 없습니다'라고 답하세요"와 같은 명확한 지시를 포함하면 된다.

프롬프트 엔지니어링에서 흔히 저지르는 실수들도 주의해야 한다. 가장 대표적인 것이 부정적 지시의 역효과다. "하지 마세요"라는 지시를 너무 강조하면 오히려 역심리 효과로 그 행동을 유발할 수 있다. 예를 들어 "절대로 rm -rf 명령어를 사용하지 마세요!"라고 강하게 금지하는 것보다는 "파일 삭제 시 안전한 방법을 사용하세요"라고 긍정적으로 표현하는 것이 효과적이다. 또한 코드로 처리 가능한 단순한 작업을 AI에게 맡기거나, 모호한 지시로 인해 가정이 필요한 부분을 남겨두는 것도 피해야 한다.

효과적인 프롬프트 엔지니어링을 위해서는 체계적인 접근이 필수적이다. 지속적으로 프롬프트를 개선하고 테스트하는 반복적 실험을 수행하고, 다양한 시나리오에서 프롬프트 성능을 측정할 수 있는 평가 도구를 활용해야 한다. 또한 효과적인 프롬프트 패턴을 문서화하여 팀원들과 공유하고, 커뮤니티에서 다른 사용자들의 프롬프트 기법을 학습하는 것도 중요하다. 

프롬프트 엔지니어링은 단순한 기술적 스킬이 아니라 AI와 효과적으로 소통하는 커뮤니케이션 기술이며, **"예술과 과학의 결합"**이다. 기술적 이해와 창의적 접근이 모두 필요하다. 각 AI 모델은 고유한 특성을 가지고 있다. Claude는 XML 태그에, GPT는 자연스러운 대화와 Markdown\index{Markdown}에, Gemini\index{Gemini}는 멀티모달 입력과 구조화된 데이터에 강점을 보인다.

궁극적으로 핵심은 **명확성, 구조화, 예시**다. 이 세 가지를 기억하고 8가지 핵심 기법을 상황과 사용하는 AI 모델에 맞게 조합하여 사용하면, AI와의 협업이 훨씬 생산적이고 효과적이 될 것이다. 특정 모델에 종속되지 않는 범용적인 프롬프트 원칙을 익히되, 각 모델의 특성을 활용하는 유연성을 갖추는 것이 중요하다. 이제 다음 장에서는 이러한 프롬프트 엔지니어링 원칙을 실제 컨텍스트 엔지니어링에 어떻게 적용할 수 있는지 구체적으로 살펴보겠다.

